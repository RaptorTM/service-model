pipeline {
    agent any

    stages {
        stage('Run main.groovy') {
            steps {
                script {
                    // Загружаем все необходимые классы
                    def support = load 'src/modules/support.groovy'
                    support.load_sm_classes()

                    echo "!!!!!!!!!!!!!!!!!! JENKINS_HOME: ${JENKINS_HOME}"
                    println "!!!!!!!!!!!!!!!!!! Current Folder !!!!!!!!!!!!!!!!!!!!!!!!"
                    // Выводим текущий путь
                    bat "echo Current Directory: %CD%"

                    // Выводим содержимое текущего каталога
                    bat(returnStdout: true, script: 'dir')

//                     // Запускаем файл main.groovy
//                     def groovyScript = load 'src/Main.groovy'
//                     groovyScript.run_test_script()



                    def groovyClass = load "src\\modules\\config\\serviceModel.groovy"

                    def Services = groovyClass.getConfig()
                    println Services['dockerfile']
//                     def Services = serviceInfo.getServiceInfoByName('uber-bff', serviceModel)
// //                      def build = new build()
//                     println Services['dockerfile']

//                     def deployEnvironment = deployEnvironmentInfo.getDeployEnvironmentInfoByName("dev", serviceModel)
//                     println deployEnvironment
//                     def cluster = clusterInfo.getClusterInfoByName(deployEnvironment.cluster, serviceModel)
//                     println cluster
//                     def landscape = landscapeInfo.getLandscapeInfoByName(cluster.landscape, serviceModel)
//                     println landscape
//                     def servicesToDeploy = serviceInfo.getAllServicesFromModel(serviceModel)
//                     println servicesToDeploy
//                     def servicesToBuild = serviceInfo.getAllServicesFromModel(serviceModel)
//                     println servicesToBuild
                }
            }
        }
    }
}